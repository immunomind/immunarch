<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic analysis and clonality • immunarch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Basic analysis and clonality">
<meta property="og:description" content="immunarch">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-128418614-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-128418614-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">immunarch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Start Here
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/v1_introduction.html">Installation &amp; troubleshooting</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">First steps</li>
    <li>
      <a href="../../articles/v2_data.html">Data loading</a>
    </li>
    <li>
      <a href="../../articles/web_only/load_mixcr.html">How-to: Loading MiXCR Data</a>
    </li>
    <li>
      <a href="../../articles/web_only/load_10x.html">How-to: Loading 10x Genomics Data</a>
    </li>
    <li>
      <a href="../../articles/web_only/v21_singlecell.html">How-to: Single-cell and paired chain data</a>
    </li>
    <li>
      <a href="../../articles/web_only/v3_basic_analysis.html">Basic statistics and clonality</a>
    </li>
    <li>
      <a href="../../articles/web_only/repFilter_v3.html">Data filtering</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Repertoire-level exploration and comparison</li>
    <li>
      <a href="../../articles/web_only/v4_overlap.html">Repertoire overlap and public clonotypes</a>
    </li>
    <li>
      <a href="../../articles/web_only/v5_gene_usage.html">Gene usage</a>
    </li>
    <li>
      <a href="../../articles/web_only/v6_diversity.html">Diversity estimation</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Clonotype-level exploration and comparison</li>
    <li>
      <a href="../../articles/web_only/v8_tracking.html">Track clonotypes across samples and time</a>
    </li>
    <li>
      <a href="../../articles/web_only/v11_db.html">Annotate clonotypes using immune receptor databases</a>
    </li>
    <li>
      <a href="../../articles/web_only/v9_kmers.html">Kmer and sequence motif analysis and visualisation</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Preparing to publication</li>
    <li>
      <a href="../../articles/web_only/v7_fixvis.html">Make your plots publication-ready with fixVis</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">BCR analysis</li>
    <li>
      <a href="../../articles/web_only/BCRpipeline.html">BCR pipeline</a>
    </li>
    <li>
      <a href="../../articles/web_only/clustering.html">Clustering</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/immunomind/covid19" class="external-link">COVID-19</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://immunomind.io" class="external-link">ImmunoMind</a>
</li>
<li>
  <a href="http://twitter.com/immunomind" class="external-link">
    <span class="fa fa-lg fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/immunomind/immunarch" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic analysis and clonality</h1>
                        <h4 data-toc-skip class="author">
<b>ImmunoMind</b> – improving design of T-cell therapies using multi-omics and AI. Research and biopharma partnerships, more details: <a href="https://immunomind.io" class="external-link">immunomind.io</a>
</h4>
            
            <h4 data-toc-skip class="date"><a href="mailto:support@immunomind.io" class="email">support@immunomind.io</a></h4>
      
      <small class="dont-index">Source: <a href="https://github.com/immunomind/immunarch/blob/master/vignettes/web_only/v3_basic_analysis.Rmd" class="external-link"><code>vignettes/web_only/v3_basic_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>v3_basic_analysis.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Basic analysis and clonality}
%\VignettePackage{immunarch}
-->
<div id="basic-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-analysis" class="anchor" aria-hidden="true"></a>Basic analysis</h1>
<p>For each task in this section <code>immunarch</code> includes separate functions that are generally self-explanatory and are written in camel-case.</p>
<p>Note: all functions in immunarch require that the input immune repertoire data list have names. If you use the <code>repLoad</code> function, you will have no issues. If you compose your list by-hand, you must name elements in the list, e.g.:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">your_data</span> <span class="co"># Your list with repertoires without names</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">your_data</span><span class="op">)</span>
<span class="co"># Output: NULL</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">your_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">your_data</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">your_data</span><span class="op">)</span>
<span class="co"># Output: Sample1 Sample2 ... Sample10</span></code></pre></div>
<p>Basic analysis functions are:</p>
<ul>
<li><p><code>repExplore</code> - to compute basic statistics, such as number of clones or distributions of lengths and counts. To explore them you need to pass the statistics, e.g. <code>count</code>, to the <code>.method</code>.</p></li>
<li><p><code>repClonality</code> - to compute the clonality of repertoires.</p></li>
<li><p><code>repOverlap</code> - to compute the repertoire overlap.</p></li>
<li><p><code>repOverlapAnalysis</code> - to analyse the repertoire overlap, including different clustering procedures and PCA.</p></li>
<li><p><code>geneUsage</code> - to compute the distributions of V or J genes.</p></li>
<li><p><code>geneUsageAnalysis</code> - to analyse the distributions of V or J genes, including clustering and PCA.</p></li>
<li><p><code>repDiversity</code> - to estimate the diversity of repertoires.</p></li>
<li><p><code>trackClonotypes</code> - to analyse the dynamics of repertoires across time points.</p></li>
<li><p><code>spectratype</code> - to compute spectratype of clonotypes.</p></li>
<li><p><code>getKmers</code> and <code>kmer_profile</code> - to compute distributions of kmers and sequence profiles.</p></li>
</ul>
<div id="how-to-visualise-analysis-results" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-visualise-analysis-results" class="anchor" aria-hidden="true"></a>How to visualise analysis results</h2>
<p>Output of each analysis function could be passed directly to the <code>vis</code> function - the general function for visualisation. Examples of usage are written below. Almost all visualisations of analysis results are support grouping data by their respective properties from the metadata table or using user-supplied properties. Grouping is possible by passing either <code>.by</code> argument or by passing both <code>.by</code> and <code>.meta</code> arguments to the <code>vis</code> function.</p>
<ol style="list-style-type: decimal">
<li>You can pass <code>.by</code> as a character vector with one or several column names from the metadata table to group your data before plotting. In this case you should provide also the <code>.meta</code> argument with the metadata table.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp_vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repExplore.html">repExplore</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_vol</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Status"</span><span class="op">)</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_vol</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Status"</span>, <span class="st">"Sex"</span><span class="op">)</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/eda-by-meta-1.png" width="960" style="display: block; margin: auto;"></p>
<ol start="2" style="list-style-type: decimal">
<li>You can pass <code>.by</code> as a character vector that exactly matches the number of samples in your data, each value should correspond to a sample’s property. It will be used to group data based on the values provided. Note that in this case you should pass NA to <code>.meta</code>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp_vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repExplore.html">repExplore</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span>
<span class="va">by_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"MS"</span>, <span class="st">"MS"</span>, <span class="st">"MS"</span>, <span class="st">"MS"</span>, <span class="st">"MS"</span>, <span class="st">"MS"</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_vol</span>, .by <span class="op">=</span> <span class="va">by_vec</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/eda-by-only-1.png" width="576" style="display: block; margin: auto;"></p>
<p>If data is grouped, than statistical tests for comparing means of groups will be performed, unless <code>.test = F</code> is supplied. In case there are only two groups, the <a href="https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test" class="external-link">Wilcoxon rank sum test</a> is performed (R function <code>wilcox.test</code> with an argument <code>exact = F</code>) for testing if there is a difference in mean rank values between two groups. In case there more than two groups, the <a href="https://en.wikipedia.org/wiki/Kruskal%E2%80%93Wallis_one-way_analysis_of_variance" class="external-link">Kruskal-Wallis test</a> is performed (R function <code>kruskal.test</code>), that is equivalent to ANOVA for ranks and it tests whether samples from different groups originated from the same distribution. A significant Kruskal-Wallis test indicates that at least one sample stochastically dominates one other sample. Adjusted for multiple comparisons P-values are plotted on the top of groups. P-value adjusting is done using the <a href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method" class="external-link">Holm method</a> (also known as Holm-Bonferroni correction). You can execute the command <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">?p.adjust</a></code> in the R console to see more.</p>
<p>Plots generated by the <code>vis</code> function as well as any ggplot2-based plots can be passed to <code>fixVis</code>—built-in software tool for making publication-ready plots:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1. Analyse</span>
<span class="va">exp_len</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repExplore.html">repExplore</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"len"</span>, .col <span class="op">=</span> <span class="st">"aa"</span><span class="op">)</span>

<span class="co"># 2. Visualise</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_len</span><span class="op">)</span>

<span class="co"># 3. Fix and make publication-ready results</span>
<span class="fu"><a href="../../reference/fixVis.html">fixVis</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></code></pre></div>
<p>See the <code>fixVis</code> tutorial <a href="https://immunarch.com/articles/web_only/v7_fixvis.html">here</a>.</p>
</div>
<div id="exploratory-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#exploratory-analysis" class="anchor" aria-hidden="true"></a>Exploratory analysis</h2>
<p>For the basic exploratory analysis such as comparing of number of reads / UMIs per repertoire or distribution use the function <code>repExplore</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exp_len</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repExplore.html">repExplore</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"len"</span>, .col <span class="op">=</span> <span class="st">"aa"</span><span class="op">)</span>
<span class="va">exp_cnt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repExplore.html">repExplore</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span>
<span class="va">exp_vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repExplore.html">repExplore</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"volume"</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_len</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_cnt</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_vol</span><span class="op">)</span>

<span class="va">p1</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/eda-1-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/eda-2-1.png" width="1344" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># You can group samples by their metainformation</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_len</span>, .by <span class="op">=</span> <span class="st">"Status"</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span>
<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_cnt</span>, .by <span class="op">=</span> <span class="st">"Sex"</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span>
<span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">exp_vol</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Status"</span>, <span class="st">"Sex"</span><span class="op">)</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span>

<span class="va">p4</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/eda-3-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p5</span> <span class="op">+</span> <span class="va">p6</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/eda-4-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="clonality" class="section level2">
<h2 class="hasAnchor">
<a href="#clonality" class="anchor" aria-hidden="true"></a>Clonality</h2>
<p>One of the ways to estimate the diversity of samples is to evaluate clonality. <code>repClonality</code> measures the amount of the most or the least frequent clonotypes. There are several methods to assess clonality, let us take a view of them. The <code>clonal.prop</code> method computes the proportion of repertoire occupied by the pools of cell clones:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">imm_pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repClonality.html">repClonality</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"clonal.prop"</span><span class="op">)</span>
<span class="va">imm_pr</span></code></pre></div>
<pre><code>##         Clones Percentage Clonal.count.prop
## A2-i129     18       10.0      0.0027556644
## A2-i131     28       10.0      0.0042728521
## A2-i133      9       10.3      0.0014077898
## A2-i132    113       10.0      0.0164987589
## A4-i191      4       11.5      0.0007773028
## A4-i192      8       10.4      0.0013738623
## MS1          2       10.1      0.0003700278
## MS2         66       10.0      0.0092372288
## MS3          2       10.6      0.0003095496
## MS4        176       10.0      0.0236336780
## MS5          3       13.2      0.0005303164
## MS6        150       10.0      0.0202456472
## attr(,"class")
## [1] "immunr_clonal_prop" "matrix"             "array"</code></pre>
<p>The <code>top</code> method considers the most abundant cell clonotypes:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">imm_top</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repClonality.html">repClonality</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"top"</span>, .head <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">3000</span>, <span class="fl">10000</span><span class="op">)</span><span class="op">)</span>
<span class="va">imm_top</span></code></pre></div>
<pre><code>##                 10        100      1000      3000 10000
## A2-i129 0.08011765 0.17282353 0.3491765 0.5844706     1
## A2-i131 0.06670588 0.15647059 0.3467059 0.5820000     1
## A2-i133 0.10505882 0.18294118 0.3655294 0.6008235     1
## A2-i132 0.02388235 0.09423529 0.3118824 0.5471765     1
## A4-i191 0.17176471 0.32047059 0.5122353 0.7475294     1
## A4-i192 0.11541176 0.22141176 0.4325882 0.6678824     1
## MS1     0.19164706 0.30894118 0.4817647 0.7170588     1
## MS2     0.04458824 0.11470588 0.2770588 0.5123529     1
## MS3     0.16482353 0.23011765 0.3575294 0.5928235     1
## MS4     0.02329412 0.07517647 0.2415294 0.4768235     1
## MS5     0.20611765 0.29188235 0.4521176 0.6874118     1
## MS6     0.02835294 0.08235294 0.2460000 0.4812941     1
## attr(,"class")
## [1] "immunr_top_prop" "matrix"          "array"</code></pre>
<p>While the <code>rare</code> method deals with the least prolific clonotypes:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">imm_rare</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repClonality.html">repClonality</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>, .method <span class="op">=</span> <span class="st">"rare"</span><span class="op">)</span>
<span class="va">imm_rare</span></code></pre></div>
<pre><code>##                 1         3        10        30       100 MAX
## A2-i129 0.6991765 0.8215294 0.8710588 0.9267059 0.9604706   1
## A2-i131 0.6969412 0.8243529 0.8995294 0.9436471 0.9869412   1
## A2-i133 0.6800000 0.8100000 0.8690588 0.8974118 0.9357647   1
## A2-i132 0.7088235 0.8831765 0.9643529 0.9951765 1.0000000   1
## A4-i191 0.5355294 0.6484706 0.7189412 0.7707059 0.8697647   1
## A4-i192 0.5976471 0.7487059 0.8342353 0.8675294 0.9156471   1
## MS1     0.5780000 0.6692941 0.7438824 0.7929412 0.8571765   1
## MS2     0.7788235 0.8891765 0.9322353 0.9718824 1.0000000   1
## MS3     0.7272941 0.7825882 0.8071765 0.8385882 0.8652941   1
## MS4     0.8109412 0.9343529 0.9725882 1.0000000 1.0000000   1
## MS5     0.6112941 0.7001176 0.7575294 0.7809412 0.8284706   1
## MS6     0.8107059 0.9208235 0.9703529 0.9897647 1.0000000   1
## attr(,"class")
## [1] "immunr_rare_prop" "matrix"           "array"</code></pre>
<p>Finally, the <code>homeo</code> method assesses the clonal space homeostasis, i.e., the proportion of the repertoire occupied by the clones of a given size:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">imm_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/repClonality.html">repClonality</a></span><span class="op">(</span><span class="va">immdata</span><span class="op">$</span><span class="va">data</span>,
  .method <span class="op">=</span> <span class="st">"homeo"</span>,
  .clone.types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Small <span class="op">=</span> <span class="fl">.0001</span>, Medium <span class="op">=</span> <span class="fl">.001</span>, Large <span class="op">=</span> <span class="fl">.01</span>, Hyperexpanded <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">imm_hom</span></code></pre></div>
<pre><code>##         Small (0 &lt; X &lt;= 1e-04) Medium (1e-04 &lt; X &lt;= 0.001)
## A2-i129                      0                   0.8634118
## A2-i131                      0                   0.8858824
## A2-i133                      0                   0.8597647
## A2-i132                      0                   0.9542353
## A4-i191                      0                   0.7135294
## A4-i192                      0                   0.8183529
## MS1                          0                   0.7248235
## MS2                          0                   0.9244706
## MS3                          0                   0.8061176
## MS4                          0                   0.9683529
## MS5                          0                   0.7520000
## MS6                          0                   0.9625882
##         Large (0.001 &lt; X &lt;= 0.01) Hyperexpanded (0.01 &lt; X &lt;= 1)
## A2-i129                0.09705882                    0.03952941
## A2-i131                0.09011765                    0.02400000
## A2-i133                0.07600000                    0.06423529
## A2-i132                0.04576471                    0.00000000
## A4-i191                0.15623529                    0.13023529
## A4-i192                0.08611765                    0.09552941
## MS1                    0.12082353                    0.15435294
## MS2                    0.06411765                    0.01141176
## MS3                    0.05917647                    0.13470588
## MS4                    0.03164706                    0.00000000
## MS5                    0.07647059                    0.17152941
## MS6                    0.03741176                    0.00000000
## attr(,"class")
## [1] "immunr_homeo" "matrix"       "array"</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">imm_top</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">imm_top</span>, .by <span class="op">=</span> <span class="st">"Status"</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/clonality-hom-vis-1-1.png" width="1056" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">imm_rare</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">imm_rare</span>, .by <span class="op">=</span> <span class="st">"Status"</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/clonality-hom-vis-1-2.png" width="1056" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">imm_hom</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../../reference/vis.html">vis</a></span><span class="op">(</span><span class="va">imm_hom</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Status"</span>, <span class="st">"Sex"</span><span class="op">)</span>, .meta <span class="op">=</span> <span class="va">immdata</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span></code></pre></div>
<p><img src="v3_basic_analysis_files/figure-html/clonality-hom-vis-1-3.png" width="1056" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.linkedin.com/in/vdnaz" class="external-link external-link">Vadim I. Nazarov</a>, <a href="https://www.linkedin.com/in/vasily-tsvetkov-227218ab" class="external-link external-link">Vasily O. Tsvetkov</a>, <a href="https://www.linkedin.com/in/erumynskiy/" class="external-link external-link">Eugene Rumynskiy</a>, <a href="https://www.linkedin.com/in/aleksandr-popov-634878105/" class="external-link external-link">Aleksandr A. Popov</a>, <a href="https://www.linkedin.com/in/ivan-balashov/" class="external-link external-link">Ivan Balashov</a>, <a href="https://www.linkedin.com/in/maria-volobueva-b0856a223/" class="external-link external-link">Maria Samokhina</a>, <a href="https://immunomind.io" class="external-link external-link">ImmunoMind</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '94207562f34b455c0796790d104e3549',
    indexName: 'immunarch',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
